# 接口文档

## 1. 用户管理模块

### 1.1 用户注册

- **请求方式：POST**
- **请求地址：`/api/user/register`**
- **请求参数：**
    - **请求体：**
  ```json
  {
    "username": "string",
    "password": "string"
  }
    ```
- **响应参数：**
- **成功：**

```json5
{
  "statusCode": 200,
  "message": "登录成功",
  "data": {
    "token": "用户 token"
  }
}
```

- **失败：**

```json5
{
  "statusCode": 430,
  "message": "注册失败",
  "data": null
}
```

### 1.2 用户登录

- **请求方式：POST**
- **请求地址：`/api/user/login`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "username": "string",
    "password": "string"
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "登录成功",
    "data": {
      "token": "用户 token"
    }
  }
  ```

- **失败：**

  ```json5
  {
    "statusCode": 431,
    "message": "用户名或密码错误",
    "data": null
  }
  ```

### 1.3 管理员功能

#### 1.3.1 管理员登录

- **请求方式：POST**
- **请求地址：`/api/admin/login`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "username": "yiyangchen",
    "password": "yiyangchenan10086dzeyulidbdjob10086"
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "登录成功",
    "data": {
      "token": "管理员 token"
    }
  }
  ```

    - **失败：**

  ```json5
  {
    "statusCode": 433,
    "message": "用户名或密码错误",
    "data": null
  }
  ```

  #### 1.3.2 管理员获取用户信息总条数
- **请求方式：POST**
- **请求地址：`/api/admin/getUserInfoCount?limit=10`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "管理员 token",
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": 10
  }
  ```

  #### 1.3.3 管理员获取用户信息
- **请求方式：POST**
- **请求地址：`/api/admin/getUserInfo?page=1&limit=10`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "管理员 token",
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": [{
      "id": 1,
      "username": "user1",
      "whetherItIsDisabledOrNot": "true"
    }// ...
    ]
  }
  ```

  #### 1.3.4 管理员禁用用户
- **请求方式：POST**
- **请求地址：`/api/admin/disableUser`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "管理员 token",
    "userId": 1
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "成功",
    "data": null
  }
  ```
  #### 1.3.5 管理员解禁用户
- **请求方式：POST**
- **请求地址：`/api/admin/enableUser`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "管理员 token",
    "userId": 1
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "成功",
    "data": null
  }
  ```

  #### 1.3.6 管理员删除用户
- **请求方式：POST**
- **请求地址：`/api/admin/deleteUser`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "管理员 token",
    "userId": 1
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "成功",
    "data": null
  }
  ```

## 2. 记账功能

### 2.1 添加账单

- **请求方式：POST**
- **请求地址：`/api/bill/addBill`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "recordEnum": "INCOME",
    "amount": 100,
    "account": "accountId",
    "type": "FOOD",
    "date": "2021-10-10",
    "remarks": "购买了牛奶"
  }
  ```

### 2.2 记录的枚举

- **请求方式：GET**
- **请求地址：`/api/bill/getRecordType`**
- **返回值：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data":{
      "INCOME": "收入",
      "EXPENDITURE": "支出",
      "TRANSFER": "转账"
    }
  }
  ```

### 2.3 查看流水

- **请求方式：POST**
- **请求地址：`/api/bill/getBillList?page=1&limit=10&lastId=1&lastDate=2021-10-10`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token"
   }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": [
      {
        "id": 1,
        "recordEnum": "income",
        "amount": 100,
        "date": "2021-10-10",
      },
      {
        "id": 2,
        "recordEnum": "expenditure",
        "amount": 200,
        "date": "2021-10-11",
      }// ...
    ]
  }
  ```

### 2.4 查看流水详情

- **请求方式：POST**
- **请求地址：`/api/bill/getBillDetail`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "id": 1
   }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": {
      "id": 1,
      "recordEnum": "income",
      "amount": 100,
      "account": "accountId",
      "type": "food",
      "date": "2021-10-10",
      "remarks": "购买了牛奶"
    }
  }
  ```

### 2.5 删除账单

- **请求方式：POST**
- **请求地址：`/api/bill/deleteBill?page=1&limit=10`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "id": 1,
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "删除成功",
    "data": null
  }
  ```

### 2.6 查看已删除的账单

- **请求方式：POST**
- **请求地址：`/api/bill/getDeletedBillList?page=1&limit=10`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token"
   }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": [
      {
        "id": 1,
        "recordEnum": "income",
        "amount": 100,
        "date": "2021-10-10",
      },
      {
        "id": 2,
        "recordEnum": "expenditure",
        "amount": 200,
        "date": "2021-10-11",
      }// ...
    ]
  }
  ```

### 2.7 恢复账单

- **请求方式：POST**
- **请求地址：`/api/bill/recoverBill`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "billId": 1
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "恢复成功",
    "data": null
  }
  ```

### 2.8 修改账单

- **请求方式：POST**
- **请求地址：`/api/bill/modifyBill?page=1?limit=10`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "id": 1,
    "recordEnum": "income",
    "amount": 100,
    "account": "accountId",
    "type": "食品",
    "date": "2021-10-10",
    "remarks": "购买了牛奶"
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "修改成功",
    "data": null
  }
  ```

### 2.9 批量上传账单（excel）

- **请求方式：POST**
- **请求地址：`/api/bill/adddBillList`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "data": [
   {
      "recordEnum": "income",
      "amount": 100,
      "account": "accountId",
      "type": "food",
      "date": "2021-10-10",
      "remarks": "购买了牛奶"
    }
  // ...
  ]
  }
  ```
    - **注意**：data为账单数组，每个账单的格式与添加账单的请求体相同。

      前端传入的excel格式如下：

      | 记录类型（只能是收入，支出，转账） | 金额 | 账户 | 类型（只能是指定类型） | 日期 | 备注 |
                                          | --- | --- | --- |-------------| --- | --- |
      | 收入 | 100 | accountId | 食品          | 2021-10-10 | 购买了牛奶 |

- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "上传成功",
    "data": null
  }
  ```

### 2.10 类型枚举

- **请求方式：GET**
- **请求地址：`/api/bill/getTypeList`**
- **返回值：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data":{
        "FOOD": "食品",
        "SHOPPING": "购物",
        "TRANSPORTATION": "交通",
        "HOUSING": "住房",
        "HEALTH": "健康",
        "FINANCE": "金融",
        "INSURANCE": "保险",
        "CLOTHING": "服装",
        "ELECTRONIC": "电子",
        "FURNITURE": "家具",
        "HOUSEHOLD": "家庭",
        "OTHERS": "其他"
  }
  }
  ```

## 3. 查询与统计

### 3.1 查询方式枚举

- **请求方式：GET**
- **请求地址：`/api/query/getSearchType`**
- **返回值：**
- **成功：**

  ```json5
  {
  "data": {
    "CATEGORY": "分类查询",
    "KEYWORD": "关键词查询",
    "AMOUNT_RANGE": "金额范围查询",
    "DATE_RANGE": "日期范围查询",
    "TYPE": "类型查询"
  },
  "message": "成功",
  "statusCode": 200
  }
  ```

### 3.2 根据日期查询流水

- **请求方式：POST**
- **请求地址：`/api/query/getBillList?searchType=DATE`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "page": 1,
    "limit": 10,
    "startDate": "2021-10-10",
    "endDate": "2021-10-11"
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": [
      {
        "id": 1,
        "recordEnum": "income",
        "amount": 100,
        "date": "2021-10-10",
      },
      {
        "id": 2,
        "recordEnum": "expenditure",
        "amount": 200,
        "date": "2021-10-11",
      }// ...
    ]
  }
  ```

### 3.3 根据账户查询流水

- **请求方式：POST**
- **请求地址：`/api/query/getBillList?searchType=ACCOUNT`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "searchType": "ACCOUNT",
    "accountId": "accountId",
    "page": 1,
    "limit": 10
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": [
      {
        "id": 1,
        "recordEnum": "income",
        "amount": 100,
        "date": "2021-10-10",
      },
      {
        "id": 2,
        "recordEnum": "expenditure",
        "amount": 200,
        "date": "2021-10-11",
      }// ...
    ]
  }
  ```

### 3.4 根据类型查询流水

- **请求方式：POST**
- **请求地址：`/api/query/getBillList?searchType=USAGE_TYPE`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "searchType": "TYPE",
    "type": "food",
    "page": 1,
    "limit": 10
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": [
      {
        "id": 1,
        "recordEnum": "income",
        "amount": 100,
        "date": "2021-10-10",
      },
      {
        "id": 2,
        "recordEnum": "expenditure",
        "amount": 200,
        "date": "2021-10-11",
      }// ...
    ]
  }
  ```

### 3.5 根据关键字查询流水

- **请求方式：POST**
- **请求地址：`/api/query/getBillList?searchType=KEYWORD`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "keyword": "购买了牛奶",
    "page": 1,
    "limit": 10
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "data": [
      {
        "id": 1,
        "recordEnum": "income",
        "amount": 100,
        "date": "2021-10-10",
      },
      {
        "id": 2,
        "recordEnum": "expenditure",
        "amount": 200,
        "date": "2021-10-11",
      }// ...
    ]
  }
  ```

### 3.7 根据金额范围查询流水

- **请求地址`/api/query/getBillList?searchType=AMOUNT_RANGE`**
- **请求方式：POST**
- **请求参数**
- **请求体：**
  ```json5
  {
    "token": "用户 token",
    "searchType": "AMOUNT_RANGE",
    "minAmount": 100,
    "maxAmount": 200,
    "page": 1,
    "limit": 10
  }
  ```

### 3.6 统计报表

- **请求方式：POST**
- **请求地址：`/api/query/getReport`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "startDate": "2021-10-10",
    "endDate": "2021-10-11"
  }
  ```
- **响应参数：**
- **成功：**

  ```json5
  {
    "statusCode": 200,
    "message": "获取成功",
    "generalIncome": 100,
    "generalExpenditure": 200,
    "generalTransfer": 200,
    "generalBalance": -300,
    "data": [
      {
        "type": "FOOD",
        "income": 100,
        "expenditure": 200,
        "transfer": 200,
        "balance": -300
  }// ...
  ]}
  ```

### 3.6 导出excel报表

- **请求方式：POST**
- **请求地址：`/api/query/exportReport`**
- **请求参数：**
    - **请求体：**
  ```json5
  {
    "token": "用户 token",
    "startDate": "2021-10-10",
    "endDate": "2021-10-11"
  }
  ```
- **响应参数：**
- **成功：**
  文件流

## 4. 账户管理

### 4.1 创建账户

- **请求方式：POST**
- **请求地址：`/api/account/addAccount`**
- **请求参数：**

```json5
    {
  "token": "用户 token",
  "name": "账户名称",
}
```